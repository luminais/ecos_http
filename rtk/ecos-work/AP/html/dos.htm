<html>
<!-- Copyright (c) Realtek Semiconductor Corp., 2003. All Rights Reserved. -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=<% getLangInfo("charset");%>">
<SCRIPT language=Javascript src="<% getLangInfo("lang");%>"></SCRIPT>
<% getIndex("no-cache"); %>
<title>DoS Setup </title>
<script language="javascript" type="text/javascript" src="util_gw.js"> </script>
<script>
var doson = <%getIndex("doson");%>;
function dosEnabledClick(){
	if(document.formDosCfg.dosEnabled.checked ){
		enableTextField(document.formDosCfg.sysfloodSYN);
		enableTextField(document.formDosCfg.sysfloodFIN);
		enableTextField(document.formDosCfg.sysfloodUDP);
		enableTextField(document.formDosCfg.sysfloodICMP);
		enableTextField(document.formDosCfg.sysfloodSYNcount);
		enableTextField(document.formDosCfg.sysfloodFINcount);
		enableTextField(document.formDosCfg.sysfloodUDPcount);
		enableTextField(document.formDosCfg.sysfloodICMPcount);
		enableTextField(document.formDosCfg.ipfloodSYN);
		enableTextField(document.formDosCfg.ipfloodFIN);
		enableTextField(document.formDosCfg.ipfloodUDP);
		enableTextField(document.formDosCfg.ipfloodICMP);
		enableTextField(document.formDosCfg.ipfloodSYNcount);
		enableTextField(document.formDosCfg.ipfloodFINcount);
		enableTextField(document.formDosCfg.ipfloodUDPcount);
		enableTextField(document.formDosCfg.ipfloodICMPcount);
		enableTextField(document.formDosCfg.TCPUDPPortScan);
		enableTextField(document.formDosCfg.portscanSensi);
		enableTextField(document.formDosCfg.ICMPSmurfEnabled);
		enableTextField(document.formDosCfg.IPLandEnabled);
		enableTextField(document.formDosCfg.IPSpoofEnabled);
		enableTextField(document.formDosCfg.IPTearDropEnabled);
		enableTextField(document.formDosCfg.PingOfDeathEnabled);
		enableTextField(document.formDosCfg.TCPScanEnabled);
		enableTextField(document.formDosCfg.TCPSynWithDataEnabled);
		enableTextField(document.formDosCfg.UDPBombEnabled);
		enableTextField(document.formDosCfg.UDPEchoChargenEnabled);
		enableTextField(document.formDosCfg.sourceIPblock);
		enableTextField(document.formDosCfg.IPblockTime);
	}
	else{
		document.formDosCfg.sysfloodSYN.checked=0;
		document.formDosCfg.sysfloodFIN.checked=0;
		document.formDosCfg.sysfloodUDP.checked=0;
		document.formDosCfg.sysfloodICMP.checked=0;
		document.formDosCfg.ipfloodSYN.checked=0;
		document.formDosCfg.ipfloodFIN.checked=0;
		document.formDosCfg.ipfloodUDP.checked=0;
		document.formDosCfg.ipfloodICMP.checked=0;
		document.formDosCfg.TCPUDPPortScan.checked=0;
		document.formDosCfg.ICMPSmurfEnabled.checked=0;
		document.formDosCfg.IPLandEnabled.checked=0;
		document.formDosCfg.IPSpoofEnabled.checked=0;
		document.formDosCfg.IPTearDropEnabled.checked=0;
		document.formDosCfg.PingOfDeathEnabled.checked=0;
		document.formDosCfg.TCPScanEnabled.checked=0;
		document.formDosCfg.TCPSynWithDataEnabled.checked=0;
		document.formDosCfg.UDPBombEnabled.checked=0;
		document.formDosCfg.UDPEchoChargenEnabled.checked=0;
		document.formDosCfg.sourceIPblock.checked=0;
		disableTextField(document.formDosCfg.sysfloodSYN);
		disableTextField(document.formDosCfg.sysfloodFIN);
		disableTextField(document.formDosCfg.sysfloodUDP);
		disableTextField(document.formDosCfg.sysfloodICMP);
		disableTextField(document.formDosCfg.sysfloodSYNcount);
		disableTextField(document.formDosCfg.sysfloodFINcount);
		disableTextField(document.formDosCfg.sysfloodUDPcount);
		disableTextField(document.formDosCfg.sysfloodICMPcount);
		disableTextField(document.formDosCfg.ipfloodSYN);
		disableTextField(document.formDosCfg.ipfloodFIN);
		disableTextField(document.formDosCfg.ipfloodUDP);
		disableTextField(document.formDosCfg.ipfloodICMP);
		disableTextField(document.formDosCfg.ipfloodSYNcount);
		disableTextField(document.formDosCfg.ipfloodFINcount);
		disableTextField(document.formDosCfg.ipfloodUDPcount);
		disableTextField(document.formDosCfg.ipfloodICMPcount);
		disableTextField(document.formDosCfg.TCPUDPPortScan);
		disableTextField(document.formDosCfg.portscanSensi);
		disableTextField(document.formDosCfg.ICMPSmurfEnabled);
		disableTextField(document.formDosCfg.IPLandEnabled);
		disableTextField(document.formDosCfg.IPSpoofEnabled);
		disableTextField(document.formDosCfg.IPTearDropEnabled);
		disableTextField(document.formDosCfg.PingOfDeathEnabled);
		disableTextField(document.formDosCfg.TCPScanEnabled);
		disableTextField(document.formDosCfg.TCPSynWithDataEnabled);
		disableTextField(document.formDosCfg.UDPBombEnabled);
		disableTextField(document.formDosCfg.UDPEchoChargenEnabled);
		disableTextField(document.formDosCfg.sourceIPblock);
		disableTextField(document.formDosCfg.IPblockTime);			
	}
}

function dosUnabledClick(){
	if(!doson){
		document.formDosCfg.sysfloodSYN.checked=0;
		document.formDosCfg.sysfloodFIN.checked=0;
		document.formDosCfg.sysfloodUDP.checked=0;
		document.formDosCfg.sysfloodICMP.checked=0;
		document.formDosCfg.ipfloodSYN.checked=0;
		document.formDosCfg.ipfloodFIN.checked=0;
		document.formDosCfg.ipfloodUDP.checked=0;
		document.formDosCfg.ipfloodICMP.checked=0;
		document.formDosCfg.TCPUDPPortScan.checked=0;
		document.formDosCfg.ICMPSmurfEnabled.checked=0;
		document.formDosCfg.IPLandEnabled.checked=0;
		document.formDosCfg.IPSpoofEnabled.checked=0;
		document.formDosCfg.IPTearDropEnabled.checked=0;
		document.formDosCfg.PingOfDeathEnabled.checked=0;
		document.formDosCfg.TCPScanEnabled.checked=0;
		document.formDosCfg.TCPSynWithDataEnabled.checked=0;
		document.formDosCfg.UDPBombEnabled.checked=0;
		document.formDosCfg.UDPEchoChargenEnabled.checked=0;
		document.formDosCfg.sourceIPblock.checked=0;
		disableTextField(document.formDosCfg.sysfloodSYN);
		disableTextField(document.formDosCfg.sysfloodFIN);
		disableTextField(document.formDosCfg.sysfloodUDP);
		disableTextField(document.formDosCfg.sysfloodICMP);
		disableTextField(document.formDosCfg.sysfloodSYNcount);
		disableTextField(document.formDosCfg.sysfloodFINcount);
		disableTextField(document.formDosCfg.sysfloodUDPcount);
		disableTextField(document.formDosCfg.sysfloodICMPcount);
		disableTextField(document.formDosCfg.ipfloodSYN);
		disableTextField(document.formDosCfg.ipfloodFIN);
		disableTextField(document.formDosCfg.ipfloodUDP);
		disableTextField(document.formDosCfg.ipfloodICMP);
		disableTextField(document.formDosCfg.ipfloodSYNcount);
		disableTextField(document.formDosCfg.ipfloodFINcount);
		disableTextField(document.formDosCfg.ipfloodUDPcount);
		disableTextField(document.formDosCfg.ipfloodICMPcount);
		disableTextField(document.formDosCfg.TCPUDPPortScan);
		disableTextField(document.formDosCfg.portscanSensi);
		disableTextField(document.formDosCfg.ICMPSmurfEnabled);
		disableTextField(document.formDosCfg.IPLandEnabled);
		disableTextField(document.formDosCfg.IPSpoofEnabled);
		disableTextField(document.formDosCfg.IPTearDropEnabled);
		disableTextField(document.formDosCfg.PingOfDeathEnabled);
		disableTextField(document.formDosCfg.TCPScanEnabled);
		disableTextField(document.formDosCfg.TCPSynWithDataEnabled);
		disableTextField(document.formDosCfg.UDPBombEnabled);
		disableTextField(document.formDosCfg.UDPEchoChargenEnabled);
		disableTextField(document.formDosCfg.sourceIPblock);
		disableTextField(document.formDosCfg.IPblockTime);	

		disableTextField(document.formDosCfg.dosEnabled);
		}
}
	
function SelectAll(){
	if(document.formDosCfg.dosEnabled.checked){
		document.formDosCfg.sysfloodSYN.checked=1;
		document.formDosCfg.sysfloodFIN.checked=1;
		document.formDosCfg.sysfloodUDP.checked=1;
		document.formDosCfg.sysfloodICMP.checked=1;
		document.formDosCfg.ipfloodSYN.checked=1;
		document.formDosCfg.ipfloodFIN.checked=1;
		document.formDosCfg.ipfloodUDP.checked=1;
		document.formDosCfg.ipfloodICMP.checked=1;
		document.formDosCfg.TCPUDPPortScan.checked=1;
		document.formDosCfg.ICMPSmurfEnabled.checked=1;
		document.formDosCfg.IPLandEnabled.checked=1;
		document.formDosCfg.IPSpoofEnabled.checked=1;
		document.formDosCfg.IPTearDropEnabled.checked=1;
		document.formDosCfg.PingOfDeathEnabled.checked=1;
		document.formDosCfg.TCPScanEnabled.checked=1;
		document.formDosCfg.TCPSynWithDataEnabled.checked=1;
		document.formDosCfg.UDPBombEnabled.checked=1;
		document.formDosCfg.UDPEchoChargenEnabled.checked=1;
	}
}

function ClearAll(){
	if(document.formDosCfg.dosEnabled.checked){
		document.formDosCfg.sysfloodSYN.checked=0;
		document.formDosCfg.sysfloodFIN.checked=0;
		document.formDosCfg.sysfloodUDP.checked=0;
		document.formDosCfg.sysfloodICMP.checked=0;
		document.formDosCfg.ipfloodSYN.checked=0;
		document.formDosCfg.ipfloodFIN.checked=0;
		document.formDosCfg.ipfloodUDP.checked=0;
		document.formDosCfg.ipfloodICMP.checked=0;
		document.formDosCfg.TCPUDPPortScan.checked=0;
		document.formDosCfg.ICMPSmurfEnabled.checked=0;
		document.formDosCfg.IPLandEnabled.checked=0;
		document.formDosCfg.IPSpoofEnabled.checked=0;
		document.formDosCfg.IPTearDropEnabled.checked=0;
		document.formDosCfg.PingOfDeathEnabled.checked=0;
		document.formDosCfg.TCPScanEnabled.checked=0;
		document.formDosCfg.TCPSynWithDataEnabled.checked=0;
		document.formDosCfg.UDPBombEnabled.checked=0;
		document.formDosCfg.UDPEchoChargenEnabled.checked=0;
	}
}

function init()
{
	var cf = document.formDosCfg;
	if(doson){
		var dosEnabled = <%getIndex("dosEnabled");%>;
		
    	if(dosEnabled & 1) 
        	cf.dosEnabled.checked = 1;
        else
        	cf.dosEnabled.checked = 0;		

		if (cf.dosEnabled.checked) {
	    	if((dosEnabled>>1) & 1)
	        	cf.sysfloodSYN.checked = 1;
	        else
	        	cf.sysfloodSYN.checked = 0;
	        
	        if((dosEnabled>>2) & 1)
	        	cf.sysfloodFIN.checked = 1;
	        else
	        	cf.sysfloodFIN.checked = 0;
	        	
	        if((dosEnabled>>3) & 1)
	        	cf.sysfloodUDP.checked = 1;
	        else
	        	cf.sysfloodUDP.checked = 0;
	        
	        if((dosEnabled>>4) & 1)
	        	cf.sysfloodICMP.checked = 1;
	        else
	        	cf.sysfloodICMP.checked = 0;

	        if((dosEnabled>>5) & 1)
	        	cf.ipfloodSYN.checked = 1;
	        else
	        	cf.ipfloodSYN.checked = 0;

	        if((dosEnabled>>6) & 1)
	        	cf.ipfloodFIN.checked = 1;
	        else
	        	cf.ipfloodFIN.checked = 0;

	        if((dosEnabled>>7) & 1)
	        	cf.ipfloodUDP.checked = 1;
	        else
	        	cf.ipfloodUDP.checked = 0;

	        if((dosEnabled>>8) & 1)
	        	cf.ipfloodICMP.checked = 1;
	        else
	        	cf.ipfloodICMP.checked = 0;

	        if((dosEnabled>>9) & 1)
	        	cf.TCPUDPPortScan.checked = 1;
	        else
	        	cf.TCPUDPPortScan.checked = 0;

	        if((dosEnabled>>10) & 1)
	        	cf.ICMPSmurfEnabled.checked = 1;
	        else
	        	cf.ICMPSmurfEnabled.checked = 0;

	        if((dosEnabled>>11) & 1)
	        	cf.IPLandEnabled.checked = 1;
	        else
	        	cf.IPLandEnabled.checked = 0;

	        if((dosEnabled>>12) & 1)
	        	cf.IPSpoofEnabled.checked = 1;
	        else
	        	cf.IPSpoofEnabled.checked = 0;

	        if((dosEnabled>>13) & 1)
	        	cf.IPTearDropEnabled.checked = 1;
	        else
	        	cf.IPTearDropEnabled.checked = 0;

	        if((dosEnabled>>14) & 1)
	        	cf.PingOfDeathEnabled.checked = 1;
	        else
	        	cf.PingOfDeathEnabled.checked = 0;

	        if((dosEnabled>>15) & 1)
	        	cf.TCPScanEnabled.checked = 1;
	        else
	        	cf.TCPScanEnabled.checked = 0;

	        if((dosEnabled>>16) & 1)
	        	cf.TCPSynWithDataEnabled.checked = 1;
	        else
	        	cf.TCPSynWithDataEnabled.checked = 0;

	        if((dosEnabled>>17) & 1)
	        	cf.UDPBombEnabled.checked = 1;
	        else
	        	cf.UDPBombEnabled.checked = 0;

	        if((dosEnabled>>18) & 1)
	        	cf.UDPEchoChargenEnabled.checked = 1;
	        else
	        	cf.UDPEchoChargenEnabled.checked = 0;

	        if((dosEnabled>>22) & 1)
	        	cf.sourceIPblock.checked = 1;
	        else
	        	cf.sourceIPblock.checked = 0;

	        if((dosEnabled>>23) & 1)
	        	cf.portscanSensi.selectedIndex = 1;
	        else
	        	cf.portscanSensi.selectedIndex = 0;
			}
		dosEnabledClick();
		}
	else
		dosUnabledClick();
}
</script>
</head>

<blockquote>
<h2><font color="#0000FF"><script>dw(dos_header)</script></font></h2>

<body onload="init();">
<table border=0 width="550" cellspacing=0 cellpadding=0>
  <tr><font size=2>
    <script>dw(dos_header_explain)</script>
  </tr>
  <tr><hr size=1 noshade align=top></tr>

<form action=/formDosCfg.htm method=POST name="formDosCfg">

  <tr><td width="300" ><font size=2><b><input type="checkbox" name="dosEnabled" value="ON" onclick="dosEnabledClick()">&nbsp;&nbsp;<script>dw(dos_enable)</script></b></font></td>
  </tr>

  <br>
  <table border="0" width=600>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodSYN" value="ON" > <font size=2><b> <script>dw(dos_sysflood_syn)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="sysfloodSYNcount" size="6" maxlength="4" value=<%getIndex("syssynFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodFIN" value="ON" > <font size=2><b> <script>dw(dos_sysflood_fin)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="sysfloodFINcount" size="6" maxlength="4" value=<%getIndex("sysfinFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodUDP" value="ON" > <font size=2><b> <script>dw(dos_sysflood_udp)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="sysfloodUDPcount" size="6" maxlength="4" value=<%getIndex("sysudpFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sysfloodICMP" value="ON" > <font size=2><b> <script>dw(dos_sysflood_icmp)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="sysfloodICMPcount" size="6" maxlength="4" value=<%getIndex("sysicmpFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>

  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodSYN" value="ON" > <font size=2><b> <script>dw(dos_ipflood_syn)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="ipfloodSYNcount" size="6" maxlength="4" value=<%getIndex("pipsynFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodFIN" value="ON" > <font size=2><b> <script>dw(dos_ipflood_fin)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="ipfloodFINcount" size="6" maxlength="4" value=<%getIndex("pipfinFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodUDP" value="ON" > <font size=2><b> <script>dw(dos_ipflood_udp)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="ipfloodUDPcount" size="6" maxlength="4" value=<%getIndex("pipudpFlood"); %> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ipfloodICMP" value="ON" > <font size=2><b> <script>dw(dos_ipflood_icmp)</script> </b></font><br></td>
  <td width="40%"><input type="text" name="ipfloodICMPcount" size="6" maxlength="4" value=<%getIndex("pipicmpFlood");%> > <font size=2><b> <script>dw(dos_packet_sec)</script></b></font><br></td></tr>

  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPUDPPortScan" value="ON" > <font size=2><b> <script>dw(dos_portscan)</script> </b></font></td>
	<td width="40%">
		<select name="portscanSensi">
			<option value=0><script>dw(dos_portscan_low)</script> </option>
			<option value=1><script>dw(dos_portscan_high)</script> </option>
		</select>
	<font size=2><b> <script>dw(dos_portscan_sensitivity)</script> </b></font></td>
  </tr>

  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="ICMPSmurfEnabled" value="ON" > <font size=2><b> <script>dw(dos_icmp_smurf)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPLandEnabled" value="ON" > <font size=2><b> <script>dw(dos_ip_land)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPSpoofEnabled" value="ON" > <font size=2><b> <script>dw(dos_ip_spoof)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="IPTearDropEnabled" value="ON" > <font size=2><b> <script>dw(dos_ip_teardrop)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="PingOfDeathEnabled" value="ON" > <font size=2><b> <script>dw(dos_pingofdeath)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPScanEnabled" value="ON" > <font size=2><b> <script>dw(dos_tcp_scan)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="TCPSynWithDataEnabled" value="ON" > <font size=2><b> <script>dw(dos_tcp_synwithdata)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="UDPBombEnabled" value="ON" > <font size=2><b> <script>dw(dos_udp_bomb)</script> </b></font></td></tr>
  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="UDPEchoChargenEnabled" value="ON" > <font size=2><b> <script>dw(dos_udp_echochargen)</script> </b></font></td></tr>

    </table>
    <br>
    <input type="button" name="selectAll" onClick="SelectAll()">&nbsp;&nbsp;
    <script>document.formDosCfg.selectAll.value=dos_select_all;</script>
    <input type="button" value=" Clear ALL " name="clearAll" onClick="ClearAll()">&nbsp;&nbsp;
    <script>document.formDosCfg.clearAll.value=dos_clear_all;</script>
    <br>
  <table border="0" width=600>

  <tr><td width="40%">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="sourceIPblock" value="ON" > <font size=2><b> <script>dw(dos_enable_srcipblocking)</script> </b></font></td>

   <td width="40%"><input type="text" name="IPblockTime" size="4" maxlength="3" value=<%getIndex("blockTime"); %> > <font size=2><b> <script>dw(dos_block_time)</script></b></font><br></td></tr>

  </table>
  <br>
  <input type="submit" value="Apply Changes" name="enableDos" >&nbsp;&nbsp;
  <script>document.formDosCfg.enableDos.value=dos_apply;</script>

  <input type="hidden" value="/dos.htm" name="submit-url">
 <script>
	dosEnabledClick();
 </script>
</form>
</table>
</body>

</html>
